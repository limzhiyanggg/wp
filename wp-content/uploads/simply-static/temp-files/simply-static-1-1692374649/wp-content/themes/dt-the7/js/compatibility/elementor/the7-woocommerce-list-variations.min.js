jQuery((function(t){class e{constructor(t){this.data=t||{},this.data.outOfStockAttributes=this.findOutOfStockAttributes(),this.data.state=this.data.state||{},this.data.$originPrice=this.data.$price.clone()}getState(t){return t?this.data.state[t]:Object.assign({},this.data.state)}render(){const e=this.getState();if(!e)return;const a=this.data.$variations.find("li"),i=Object.keys(e).filter((function(t){return!!t})).map((function(t){return"a."+t+"_"+e[t]})).join(",");a.removeClass("active"),a.find(i).each((function(){t(this).parent().addClass("active")})),this.handleOutOfStockVisibility(this.findMatchingOutOfStockVariations());const n=this.findMatchingVariation();n?(this.data.$addToCartButton.attr("data-product_id",n.variation_id),this.data.$addToCartButton.removeClass("variation-btn-disabled"),n.price_html&&this.updateProductPriceData(t(n.price_html))):(this.data.$addToCartButton.attr("data-product_id",""),this.data.$addToCartButton.addClass("variation-btn-disabled"),this.updateProductPriceData(this.data.$originPrice.clone()))}updateState(t){this.data.state=Object.assign({},this.data.state,t),this.render()}findMatchingVariation(){const t=this.data.variations,e=this.getState();for(var a=[],i=0;i<t.length;i++){var n=t[i];this.isExactMatch(n.attributes,e)&&a.push(n)}return a.shift()}updateProductPriceData(t){this.data.$price.replaceWith(t),this.data.$price=t}handleOutOfStockVisibility(t){const e=t||this.data.outOfStockAttributes,a=this.data.$variations.find("li a");a.removeClass("out-of-stock");for(const[t,i]of Object.entries(e))if(i.length){const e=i.slice().map((function(e){return"."+t+"_"+e})).join(",");a.filter(e).addClass("out-of-stock")}}findMatchingOutOfStockVariations(){const t=this,e=this.data.variations,a=this.getState();let i=[];for(var n=0;n<e.length;n++){const t=e[n];!t.is_in_stock&&this.isMatch(t.attributes,a)&&i.push(t)}let o=Object.assign({},this.data.outOfStockAttributes);return i.forEach((function(e){for(const[a,i]of Object.entries(e.attributes))t.getState(a)!==i&&(o[a]=o[a].slice()||[],-1===o[a].indexOf(i)&&o[a].push(i))})),o}findOutOfStockAttributes(){const t=this.data.variations;let e=[],a=[],i={};for(let i=0;i<t.length;i++){let n=t[i];n.is_in_stock?e.push(Object.entries(n.attributes)):a.push(Object.entries(n.attributes))}e=[].concat(...e),a=[].concat(...a);const n=function(t,e){const a=e[0],i=e[1];return t[a]=t[a]||[],t[a].push(i),t},o=e.reduce(n,{}),s=a.reduce(n,{});for(const[t,e]of Object.entries(s))o[t]&&(i[t]=e.filter((function(e){return!o[t].includes(e)})));return i}isMatch(t,e){var a=!1;for(var i in t)if(t.hasOwnProperty(i)){var n=t[i],o=e[i];void 0!==n&&void 0!==o&&0!==n.length&&0!==o.length&&n===o&&(a=!0)}return a}isExactMatch(t,e){var a=!0;for(var i in t)if(t.hasOwnProperty(i)){var n=t[i],o=e[i];(void 0===n||void 0===o||0===o.length||0!==n.length&&n!==o)&&(a=!1)}return a}}t.productsVariations=function(a){const i=t(a),n=new The7ElementorSettings(i);let o={};t.data(a,"productsVariations",i),o={init:function(){i.find("[data-product_variations]").each((function(){const a=t(this),i=a.find(".products-variations"),o=a.find(".box-button"),s=new e({variations:a.data("product_variations"),$addToCartButton:o,$variations:i,$price:a.find("span.price"),state:a.data("default_attributes")||{}});i.find("li a").data("the7_product_variations_obj",s),o.attr("data-product_id",""),o.on("click",(function(e){const a=t(this);if("n"==n.getCurrentDeviceSetting("show_variations"))return e.preventDefault(),void window.location.assign(a.attr("href"));a.is(".variation-btn-disabled")&&e.preventDefault()})),s.render()}));const a=i.find(".products-variations li a");if(t(".touchevents").length){let e,i;a.on("touchstart",(function(t){e=t.originalEvent.touches[0].pageY,i=t.originalEvent.touches[0].pageX})),a.on("touchend",(function(a){a.preventDefault();let n=a.originalEvent.changedTouches[0].pageX,s=a.originalEvent.changedTouches[0].pageY;if(e===s||i===n){const e=t(this);o.selectAttribute(e)}}))}else a.on("click",(function(e){e.preventDefault();const a=t(this);o.selectAttribute(a)}));if(!!t("html.mobile-true").length){const e=i.find(".trigger-img-hover");e.each((function(){const a=t(this);let s,r;if(a.hasClass("woo-ready"))return;const c=!!a.closest(".product-type-variable",i).length;a.on("touchstart",(function(t){s=t.originalEvent.touches[0].pageY,r=t.originalEvent.touches[0].pageX})),a.on("touchend",(function(a){const i=t(this),d=a.originalEvent.changedTouches[0].pageX,u=a.originalEvent.changedTouches[0].pageY,h=!i.hasClass("is-clicked");let l=h;if(h){let h;if(i.hasClass("woo-buttons-on-img"))h=!0;else{const t=i.find(".woo-buttons-on-img").get(0);h=a.originalEvent&&t&&a.originalEvent.composedPath().includes(t)}if(h&&t(a.target).closest(".products-variations-wrap, .woo-list-buttons",i).length){const t=n.getCurrentDeviceSetting("show_variations_on_hover"),e=n.getCurrentDeviceSetting("show_btn_on_hover");(!c||t&&"on-hover"!==t)&&(e&&"on-hover"!==e)&&(l=!1)}if(s==u||r==d){e.removeClass("is-clicked"),i.addClass("is-clicked");const t={boundaryElement:i.get(0),$affectedElements:e};elementorFrontend.elements.$body.off("touchstart",o.onOuterTouchHandler).on("touchstart",t,o.onOuterTouchHandler)}}l&&a.preventDefault()})),a.addClass("woo-ready")}))}},selectAttribute:function(t){if(t.is(".out-of-stock")||"n"===n.getCurrentDeviceSetting("show_add_to_cart"))return;const e=t.closest("ul").attr("data-atr");t.data("the7_product_variations_obj").updateState({[e]:t.parent().hasClass("active")?"":String(t.data("id"))})},onOuterTouchHandler:function(t){t.originalEvent&&t.data&&t.data.boundaryElement&&!t.originalEvent.composedPath().includes(t.data.boundaryElement)&&t.data.$affectedElements&&t.data.$affectedElements.removeClass("is-clicked")&&elementorFrontend.elements.$body.off("touchstart",o.onOuterTouchHandler)}},o.init()},t.fn.productsVariations=function(){return this.each((function(){void 0!==t(this).data("productsVariations")&&t(this).removeData("productsVariations"),new t.productsVariations(this)}))}})),jQuery(window).on("elementor/frontend/init",(function(){const t=function(t,e){e((function(){t.productsVariations()}))};elementorFrontend.hooks.addAction("frontend/element_ready/the7-wc-products.default",t),elementorFrontend.hooks.addAction("frontend/element_ready/the7-wc-products-carousel.default",t)}));